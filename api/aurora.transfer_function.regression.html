

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>aurora.transfer_function.regression package &mdash; aurora 0.3.13 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=d0ab9f1a"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="aurora.transfer_function.weights package" href="aurora.transfer_function.weights.html" />
    <link rel="prev" title="aurora.transfer_function.plot package" href="aurora.transfer_function.plot.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            aurora
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user-docs/installing.html">Installing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/operate_aurora.html">Build an MTH5 and Operate the Aurora Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/operate_aurora.html#1.-Build-an-MTH5-file-from-Earthscope-archives">1. Build an MTH5 file from Earthscope archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/operate_aurora.html#2:-Process-Data">2: Process Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/operate_aurora.html#Here-is-one-way-to-select-a-single-run:">Here is one way to select a single run:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/operate_aurora.html#To-discard-runs-that-are-not-very-long">To discard runs that are not very long</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/operate_aurora.html#To-process-only-a-segment-of-data">To process only a segment of data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/operate_aurora.html#Exercise:">Exercise:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/operate_aurora.html#id1">Exercise:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/dataset_definition.html">Dataset Definition DataFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/dataset_definition.html#Excercise:">Excercise:</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/processing_configuration.html">Processing Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/processing_configuration.html#Example-of-making-a-KernelDataset-from-an-mth5">Example of making a KernelDataset from an mth5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/processing_configuration.html#EMTF-Band-Setup-File">EMTF Band Setup File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/earthscope_magnetic_data_tutorial.html">Accessing Magnetic Field Data from EarthScope Using MTH5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/earthscope_magnetic_data_tutorial.html#0.-Getting-started">0. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/earthscope_magnetic_data_tutorial.html#1.-Exploring-the-data-at-EarthScope">1. Exploring the data at EarthScope</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/earthscope_magnetic_data_tutorial.html#2.-Case-Study:">2. Case Study:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/earthscope_magnetic_data_tutorial.html#3.-Define-request-dataframe">3. Define request dataframe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/earthscope_magnetic_data_tutorial.html#4.-Build-MTH5">4. Build MTH5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/earthscope_magnetic_data_tutorial.html#5.-Build-MTH5-(with-data)">5. Build MTH5 (with data)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/earthscope_magnetic_data_tutorial.html#6.-Calibrating-time-series">6. Calibrating time series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/earthscope_magnetic_data_tutorial.html#7.-Comparison-of-time-series">7. Comparison of time series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/earthscope_magnetic_data_tutorial.html#TODO:-9.-Access-USGS-data-directly">TODO: 9. Access USGS data directly</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/process_cas04_multiple_station.html">Process CAS04 with Remote Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/process_cas04_multiple_station.html#Make-MTH5-from-IRIS-Data-Managment-Center-v0.2.0">Make MTH5 from IRIS Data Managment Center v0.2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/process_cas04_multiple_station.html#To-compare-with-the-archived-file,-we-need-to-set-the-coordinate-system-to-geographic">To compare with the archived file, we need to set the coordinate system to geographic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/process_cas04_multiple_station.html#Part-II:-Logic-to-save-FCs">Part II: Logic to save FCs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/process_cas04_multiple_station.html#Now-that-the-FCs-are-saved-we-can-access-them:|">Now that the FCs are saved we can access them:|</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/process_cas04_multiple_station.html#Absolute-Minimal-Example">Absolute Minimal Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/synthetic_data_processing.html">Synthetic Data Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/synthetic_data_processing.html#Feature-Storage-Experimental-work-in-progress">Feature Storage <strong>Experimental work in progress</strong></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">aurora</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="aurora.html">aurora package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="aurora.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="aurora.config.html">aurora.config package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aurora.pipelines.html">aurora.pipelines package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aurora.sandbox.html">aurora.sandbox package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aurora.test_utils.html">aurora.test_utils package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aurora.time_series.html">aurora.time_series package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="aurora.transfer_function.html">aurora.transfer_function package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="aurora.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="aurora.html#module-aurora.general_helper_functions">aurora.general_helper_functions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="aurora.html#module-aurora">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">aurora</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">aurora</a></li>
          <li class="breadcrumb-item"><a href="aurora.html">aurora package</a></li>
          <li class="breadcrumb-item"><a href="aurora.transfer_function.html">aurora.transfer_function package</a></li>
      <li class="breadcrumb-item active">aurora.transfer_function.regression package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/aurora.transfer_function.regression.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="aurora-transfer-function-regression-package">
<h1>aurora.transfer_function.regression package<a class="headerlink" href="#aurora-transfer-function-regression-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-aurora.transfer_function.regression.RME">
<span id="aurora-transfer-function-regression-rme-module"></span><h2>aurora.transfer_function.regression.RME module<a class="headerlink" href="#module-aurora.transfer_function.regression.RME" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>This module contains the regression M-estimator for non-remote reference regression.</p>
</div></blockquote>
<p>Development Notes:</p>
<p>follows Gary’s TRME.m in iris_mt_scratch/egbert_codes-20210121T193218Z-001/egbert_codes/matlabPrototype_10-13-20/TF/classes</p>
<blockquote>
<div><p>(Complex) regression-M estimate for the model  Y = X*b
Allows multiple columns of Y, but estimates b for each column separately</p>
<p>TODO: Consider making a QR-Estimator class between RegressionEstimator and RMEEstimator</p>
<p>Notes: QR-decomposition
The QR-decomposition is employed on the matrix of input variables X.
X = Q R where Q is unitary/orthogonal and R upper triangular.
Since X is [n_data x n_channels_in] Q is [n_data x n_data].</p>
</div></blockquote>
<p>Wikipedia has a nice description of the QR factorization: <a class="reference external" href="https://en.wikipedia.org/wiki/QR_decomposition">https://en.wikipedia.org/wiki/QR_decomposition</a>
The point of the QR decomposition is to transform the data into a domain where the inversion is done with a triangular matrix.</p>
<p>The symbol QH will denote the conjugate transpose of the matrix Q.</p>
<p>We employ here the “economical” form of the QR decomposition, so that Q is not square,
and not in fact unitary.  This is because its inverse is not defined (as it isn’t
square). Q does however obey: Q.H &#64; Q = I.</p>
<p>Really Q = [Q1 | Q2] where Q1 has as many columns as there are input variables
and Q2 is a matrix of zeros.</p>
<p>QQH is the projection matrix, or hat matrix equivalent to X(XHX)^-1XH.
<a class="reference external" href="https://math.stackexchange.com/questions/3360485/projection-matrix-expressed-as-qr-identity">https://math.stackexchange.com/questions/3360485/projection-matrix-expressed-as-qr-identity</a></p>
<p>The quantity QHY floating around is a convenience matrix that makes computing the
predicted data less numerically expensive.  The use of QHY is not so much physically
meaningful as it is a trick to compute more efficiently the predicted data QQHY.</p>
<p>The predicted data Y_hat = QQHY (since QQH is proj mtx)
but, when computing the sums of squares of Y_hat, such as we do in the error
variances calculation, we can compute  QHY2 = np.linalg.norm(QHY, axis=0) ** 2
instead of QQHY2 = Y_hat2 = np.linalg.norm(Y_hat, axis=0) ** 2 since
Y_hat.H &#64; Y_hat = QQHY.H &#64; QQHY = QHY.H &#64; Q.H &#64; Q &#64; QHY = QHY.H &#64; QHY.</p>
<p>The predicted data has to lie in span of the columns in the design matrix X.
The predicted data has to be a linear combination of the columns of Y.
Q is an orthogonal basis for the columns of X.
The norms of QQHY and QHY are the same</p>
<blockquote>
<div><p>MATLAB Documentation:
<a class="reference external" href="https://www.mathworks.com/help/matlab/ref/qr.html">https://www.mathworks.com/help/matlab/ref/qr.html</a></p>
</div></blockquote>
<p>Matlab’s reference to the “economy” representation is what Trefethen and Bau
call the “reduced QR factorization”.  Golub &amp; Van Loan (1996, §5.2) call Q1R1
the thin QR factorization of A;</p>
<p>There are several discussions online about the differences in
numpy, scipy, sklearn, skcuda etc.
<a class="reference external" href="https://mail.python.org/pipermail/numpy-discussion/2012-November/064485.html">https://mail.python.org/pipermail/numpy-discussion/2012-November/064485.html</a>
We will default to using numpy for now.
Note that numpy’s default is to use the “reduced” form of Q, R.  R isupper-right triangular.</p>
<p>This is cute:
<a class="reference external" href="https://stackoverflow.com/questions/26932461/conjugate-transpose-operator-h-in-numpy">https://stackoverflow.com/questions/26932461/conjugate-transpose-operator-h-in-numpy</a></p>
<p>The Matlab mldivide flowchart can be found here:
<a class="reference external" href="https://stackoverflow.com/questions/18553210/how-to-implement-matlabs-mldivide-a-k-a-the-backslash-operator">https://stackoverflow.com/questions/18553210/how-to-implement-matlabs-mldivide-a-k-a-the-backslash-operator</a>
And the matlab mldivide documentation here
<a class="reference external" href="http://matlab.izmiran.ru/help/techdoc/ref/mldivide.html">http://matlab.izmiran.ru/help/techdoc/ref/mldivide.html</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME.RME">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aurora.transfer_function.regression.RME.</span></span><span class="sig-name descname"><span class="pre">RME</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME.html#RME"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME.RME" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator" title="aurora.transfer_function.regression.m_estimator.MEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">MEstimator</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Q</span></code></dt><dd><p>Returns the Q matrix from the QR decomposition</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QH</span></code></dt><dd><p>Returns the conjugate transpose of the Q matrix from the QR decomposition</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QHY</span></code></dt><dd><p>Returns the QH &#64; Y</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QHYc</span></code></dt><dd><p>Returns the matrix QH &#64; Yc This is Q.conj().T from the QR decomposition multiplied with the cleaned data.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">R</span></code></dt><dd><p>Returns the R matrix from the QR decomposition</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Y_hat</span></code></dt><dd><p>returns the most recent predicted data</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">correction_factor</span></code></dt><dd><p>Return teh correction factor for the residual variance.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">degrees_of_freedom</span></code></dt><dd><p>gets the number of degress of freedom in the dataset.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_channel_names</span></code></dt><dd><p>returns the list of channel names associated with X</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">inverse_signal_covariance</span></code></dt><dd><p>Returns the inverse signal covariance matrix of the input channels as xarray</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_underdetermined</span></code></dt><dd><p>Check if the regression problem is under-determined</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_channels_in</span></code></dt><dd><p>Returns the number of input channels.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_channels_out</span></code></dt><dd><p>number of output variables</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_data</span></code></dt><dd><p>Return the number of multivariate observations in the regression dataset.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">noise_covariance</span></code></dt><dd><p>Returns the noise covariance matrix of the output channels  as xarray</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_channel_names</span></code></dt><dd><p>returns the list of channel names associated with Y</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">r0</span></code></dt><dd><p>returns the Huber r0 value</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">residual_variance</span></code></dt><dd><p>returns the residual variance</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">u0</span></code></dt><dd><p>returns the u0 threshold for redescending regression step</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_huber_regression</span></code>()</p></td>
<td><p>This is the 'convergence loop' from RME, RME_RR</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_redecending_influence_function</span></code>()</p></td>
<td><p>Performs one or two iterations with re-descending influence curve cleaned data</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">b_to_xarray</span></code>()</p></td>
<td><p>Wraps the TF results as an xarray</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.RME.RME.compute_inverse_signal_covariance" title="aurora.transfer_function.regression.RME.RME.compute_inverse_signal_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_inverse_signal_covariance</span></code></a>()</p></td>
<td><p>Computes the inverse signal covariance matrix of the input channels.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_noise_covariance</span></code>()</p></td>
<td><p>Computes the noise covariance (covariance of the residuals)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_squared_coherence</span></code>()</p></td>
<td><p>Updates the array self.R2</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate</span></code>()</p></td>
<td><p>Executes the regression</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_ols</span></code>([mode])</p></td>
<td><p>Solve Y = Xb with ordinary least squares, not robust regression.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">initial_estimate</span></code>()</p></td>
<td><p>Make first estimate of TF (b), Y_hat, and residual_variance</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">qr_decomposition</span></code>([X, sanity_check])</p></td>
<td><p>performs QR decomposition on input matrix X.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">residual_variance_method1</span></code>()</p></td>
<td><p>returns the residual variance of the output channels.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">residual_variance_method2</span></code>()</p></td>
<td><p>Returns the residual variance of the output channels (error variances).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_underdetermined</span></code>()</p></td>
<td><p>Solves the regression problem if it is under-determined -- Not Stable</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_QHYc</span></code>()</p></td>
<td><p>Updates the QHYc matrix with the most recent cleaned data</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.RME.RME.update_b" title="aurora.transfer_function.regression.RME.RME.update_b"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_b</span></code></a>()</p></td>
<td><p>Solve the regression problem using the latest cleaned data via QR-decompostion.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.RME.RME.update_residual_variance" title="aurora.transfer_function.regression.RME.RME.update_residual_variance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_residual_variance</span></code></a>([correction_factor])</p></td>
<td><p>updates residual variance from most recent cleaned and predicted data</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_y_cleaned_via_huber_weights</span></code>()</p></td>
<td><p>Updates the values of self.Yc and self.expectation_psi_prime</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_y_cleaned_via_redescend_weights</span></code>()</p></td>
<td><p>Updates estimate for self.Yc as a match-filtered sum of Y and Y_hat.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.RME.RME.update_y_hat" title="aurora.transfer_function.regression.RME.RME.update_y_hat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_y_hat</span></code></a>()</p></td>
<td><p>Update the predicted_data $hat{Y}$</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME.RME.compute_inverse_signal_covariance">
<span class="sig-name descname"><span class="pre">compute_inverse_signal_covariance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME.html#RME.compute_inverse_signal_covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME.RME.compute_inverse_signal_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the inverse signal covariance matrix of the input channels.</p>
<p>Development Notes:
Note that because X = QR, we have
X.H &#64; X = (QR).H &#64; QR = R.H Q.H Q R = R.H &#64; R
i.e. computing R.H &#64; R below is just computing the signal covariance matrix of X</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME.RME.update_b">
<span class="sig-name descname"><span class="pre">update_b</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME.html#RME.update_b"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME.RME.update_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the regression problem using the latest cleaned data via QR-decompostion.
matlab was: b = RQTY;</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME.RME.update_residual_variance">
<span class="sig-name descname"><span class="pre">update_residual_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">correction_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME.html#RME.update_residual_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME.RME.update_residual_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>updates residual variance from most recent cleaned and predicted data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME.RME.update_y_hat">
<span class="sig-name descname"><span class="pre">update_y_hat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME.html#RME.update_y_hat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME.RME.update_y_hat" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the predicted_data $hat{Y}$</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-aurora.transfer_function.regression.RME_RR">
<span id="aurora-transfer-function-regression-rme-rr-module"></span><h2>aurora.transfer_function.regression.RME_RR module<a class="headerlink" href="#module-aurora.transfer_function.regression.RME_RR" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>This module contains the regression M-estimator for remote reference regression.</p>
</div></blockquote>
<p>Development Notes:
- follows Gary’s TRME.m in
iris_mt_scratch/egbert_codes-20210121T193218Z-001/egbert_codes/matlabPrototype_10-13-20/TF/classes</p>
<dl class="py class">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME_RR.RME_RR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aurora.transfer_function.regression.RME_RR.</span></span><span class="sig-name descname"><span class="pre">RME_RR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME_RR.html#RME_RR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME_RR.RME_RR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator" title="aurora.transfer_function.regression.m_estimator.MEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">MEstimator</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Q</span></code></dt><dd><p>Returns the Q matrix from the QR decomposition</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QH</span></code></dt><dd><p>Returns the conjugate transpose of the Q matrix from the QR decomposition</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.RME_RR.RME_RR.QHX" title="aurora.transfer_function.regression.RME_RR.RME_RR.QHX"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QHX</span></code></a></dt><dd><p>Returns the matrix QH &#64; X</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QHY</span></code></dt><dd><p>Returns the QH &#64; Y</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QHYc</span></code></dt><dd><p>Returns the matrix QH &#64; Yc This is Q.conj().T from the QR decomposition multiplied with the cleaned data.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">R</span></code></dt><dd><p>Returns the R matrix from the QR decomposition</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Y_hat</span></code></dt><dd><p>returns the most recent predicted data</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">correction_factor</span></code></dt><dd><p>Return teh correction factor for the residual variance.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">degrees_of_freedom</span></code></dt><dd><p>gets the number of degress of freedom in the dataset.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_channel_names</span></code></dt><dd><p>returns the list of channel names associated with X</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">inverse_signal_covariance</span></code></dt><dd><p>Returns the inverse signal covariance matrix of the input channels as xarray</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_underdetermined</span></code></dt><dd><p>Check if the regression problem is under-determined</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_channels_in</span></code></dt><dd><p>Returns the number of input channels.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_channels_out</span></code></dt><dd><p>number of output variables</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_data</span></code></dt><dd><p>Return the number of multivariate observations in the regression dataset.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">noise_covariance</span></code></dt><dd><p>Returns the noise covariance matrix of the output channels  as xarray</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_channel_names</span></code></dt><dd><p>returns the list of channel names associated with Y</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">r0</span></code></dt><dd><p>returns the Huber r0 value</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">residual_variance</span></code></dt><dd><p>returns the residual variance</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">u0</span></code></dt><dd><p>returns the u0 threshold for redescending regression step</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_huber_regression</span></code>()</p></td>
<td><p>This is the 'convergence loop' from RME, RME_RR</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_redecending_influence_function</span></code>()</p></td>
<td><p>Performs one or two iterations with re-descending influence curve cleaned data</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">b_to_xarray</span></code>()</p></td>
<td><p>Wraps the TF results as an xarray</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.RME_RR.RME_RR.check_for_enough_data_for_rr_estimate" title="aurora.transfer_function.regression.RME_RR.RME_RR.check_for_enough_data_for_rr_estimate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_for_enough_data_for_rr_estimate</span></code></a>()</p></td>
<td><p>Raises exception if not enough data for remote reference estimate</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.RME_RR.RME_RR.check_for_nan" title="aurora.transfer_function.regression.RME_RR.RME_RR.check_for_nan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_for_nan</span></code></a>()</p></td>
<td><p>Raises exception if NaN in any of the regression data</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.RME_RR.RME_RR.check_reference_data_shape" title="aurora.transfer_function.regression.RME_RR.RME_RR.check_reference_data_shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_reference_data_shape</span></code></a>()</p></td>
<td><p>Raises exception if data shape check fails.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.RME_RR.RME_RR.compute_inverse_signal_covariance" title="aurora.transfer_function.regression.RME_RR.RME_RR.compute_inverse_signal_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_inverse_signal_covariance</span></code></a>()</p></td>
<td><p>Computes the inverse signal covariance matrix of the input channels.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_noise_covariance</span></code>()</p></td>
<td><p>Computes the noise covariance (covariance of the residuals)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_squared_coherence</span></code>()</p></td>
<td><p>Updates the array self.R2</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate</span></code>()</p></td>
<td><p>Executes the regression</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_ols</span></code>([mode])</p></td>
<td><p>Solve Y = Xb with ordinary least squares, not robust regression.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">initial_estimate</span></code>()</p></td>
<td><p>Make first estimate of TF (b), Y_hat, and residual_variance</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">qr_decomposition</span></code>([X, sanity_check])</p></td>
<td><p>performs QR decomposition on input matrix X.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">residual_variance_method1</span></code>()</p></td>
<td><p>returns the residual variance of the output channels.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">residual_variance_method2</span></code>()</p></td>
<td><p>Returns the residual variance of the output channels (error variances).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_underdetermined</span></code>()</p></td>
<td><p>Solves the regression problem if it is under-determined -- Not Stable</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_QHYc</span></code>()</p></td>
<td><p>Updates the QHYc matrix with the most recent cleaned data</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.RME_RR.RME_RR.update_b" title="aurora.transfer_function.regression.RME_RR.RME_RR.update_b"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_b</span></code></a>()</p></td>
<td><p>Updates the tf estimate data</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.RME_RR.RME_RR.update_residual_variance" title="aurora.transfer_function.regression.RME_RR.RME_RR.update_residual_variance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_residual_variance</span></code></a>([correction_factor])</p></td>
<td><p>updates residual variance from most recent cleaned and predicted data</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_y_cleaned_via_huber_weights</span></code>()</p></td>
<td><p>Updates the values of self.Yc and self.expectation_psi_prime</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_y_cleaned_via_redescend_weights</span></code>()</p></td>
<td><p>Updates estimate for self.Yc as a match-filtered sum of Y and Y_hat.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.RME_RR.RME_RR.update_y_hat" title="aurora.transfer_function.regression.RME_RR.RME_RR.update_y_hat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_y_hat</span></code></a>()</p></td>
<td><p>updates the predicted data</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME_RR.RME_RR.QHX">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QHX</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.RME_RR.RME_RR.QHX" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the matrix QH &#64; X</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME_RR.RME_RR.check_for_enough_data_for_rr_estimate">
<span class="sig-name descname"><span class="pre">check_for_enough_data_for_rr_estimate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME_RR.html#RME_RR.check_for_enough_data_for_rr_estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME_RR.RME_RR.check_for_enough_data_for_rr_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Raises exception if not enough data for remote reference estimate</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME_RR.RME_RR.check_for_nan">
<span class="sig-name descname"><span class="pre">check_for_nan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME_RR.html#RME_RR.check_for_nan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME_RR.RME_RR.check_for_nan" title="Permalink to this definition">¶</a></dt>
<dd><p>Raises exception if NaN in any of the regression data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME_RR.RME_RR.check_reference_data_shape">
<span class="sig-name descname"><span class="pre">check_reference_data_shape</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME_RR.html#RME_RR.check_reference_data_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME_RR.RME_RR.check_reference_data_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Raises exception if data shape check fails.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME_RR.RME_RR.compute_inverse_signal_covariance">
<span class="sig-name descname"><span class="pre">compute_inverse_signal_covariance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME_RR.html#RME_RR.compute_inverse_signal_covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME_RR.RME_RR.compute_inverse_signal_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the inverse signal covariance matrix of the input channels.</p>
<p>Development Notes:
Original Matlab code was basically this one-liner:
Cov_SS = (self.ZH &#64;self.X) (self.XH &#64; self.X) / (self.XH &#64;self.Z)
I broke the above line into B/A where
B = (self.ZH &#64;self.X) (self.XH &#64; self.X), and A = (self.XH &#64;self.Z)
Then follow matlab cookbook, B/A for matrices = (A’B’)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME_RR.RME_RR.update_b">
<span class="sig-name descname"><span class="pre">update_b</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME_RR.html#RME_RR.update_b"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME_RR.RME_RR.update_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the tf estimate data</p>
<p>matlab code was: b = QTXQTY</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME_RR.RME_RR.update_residual_variance">
<span class="sig-name descname"><span class="pre">update_residual_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">correction_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME_RR.html#RME_RR.update_residual_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME_RR.RME_RR.update_residual_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>updates residual variance from most recent cleaned and predicted data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.RME_RR.RME_RR.update_y_hat">
<span class="sig-name descname"><span class="pre">update_y_hat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/RME_RR.html#RME_RR.update_y_hat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.RME_RR.RME_RR.update_y_hat" title="Permalink to this definition">¶</a></dt>
<dd><p>updates the predicted data</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-aurora.transfer_function.regression.base">
<span id="aurora-transfer-function-regression-base-module"></span><h2>aurora.transfer_function.regression.base module<a class="headerlink" href="#module-aurora.transfer_function.regression.base" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>This module contains the base class for regression functions.</dt><dd><p>It follows Gary Egbert’s EMTF Matlab code TRegression.m in
which can be found in</p>
</dd>
</dl>
<p>iris_mt_scratch/egbert_codes-20210121T193218Z-001/egbert_codes/matlabPrototype_10-13-20/TF/classes</p>
<p>This class originally used numpy arrays to make adapting the Matlab easier, but
experimental support for xarray is now added (2024).</p>
<dl class="py class">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aurora.transfer_function.regression.base.</span></span><span class="sig-name descname"><span class="pre">RegressionEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X:</span> <span class="pre">~xarray.core.dataset.Dataset</span> <span class="pre">|</span> <span class="pre">~xarray.core.dataarray.DataArray</span> <span class="pre">|</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y:</span> <span class="pre">~xarray.core.dataset.Dataset</span> <span class="pre">|</span> <span class="pre">~xarray.core.dataarray.DataArray</span> <span class="pre">|</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_control:</span> <span class="pre">~aurora.transfer_function.regression.iter_control.IterControl</span> <span class="pre">=</span> <span class="pre">&lt;aurora.transfer_function.regression.iter_control.IterControl</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_channel_names:</span> <span class="pre">list</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channel_names:</span> <span class="pre">list</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/base.html#RegressionEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract base class for solving Y = X*b + epsilon for b, complex-valued</p>
<p>Many of the robust transfer estimation methods we will use repeat the
model of solving Y = X*b +epsilon for b.  X is variously called the “input”,
“predictor”, “explanatory”, “confounding”, “independent” “exogenous”, variable(s)
or the “design matrix”, “model matrix” or “regressor matrix”.
Y are variously called the “output”, “predicted”, “outcome”,
“response”, “endogenous”, “regressand”, or “dependent” variable.  I will try to
use input and output.</p>
<p>When we “regress Y on X”, we use the values of variable X to predict
those of Y.</p>
<p>Typically operates on single “frequency_band”.
Allows multiple columns of Y, but estimates b for each column separately.</p>
<p>Estimated signal and noise covariance matrices can be used to compute error
together to compute covariance for the matrix of regression coefficients b</p>
<p>If the class has public attributes, they may be documented here
in an <code class="docutils literal notranslate"><span class="pre">Attributes</span></code> section and follow the same formatting as a
function’s <code class="docutils literal notranslate"><span class="pre">Args</span></code> section. Alternatively, attributes may be documented
inline with the attribute’s declaration (see __init__ method below).</p>
<p>Properties created with the <code class="docutils literal notranslate"><span class="pre">&#64;property</span></code> decorator should be documented
in the property’s getter method.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator._X">
<span class="sig-name descname"><span class="pre">_X</span></span><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator._X" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying dataset is assumed to be if shape nCH x nObs (normally 2-dimensional)
These are the input variables.  In the matlab codes each observation
corresponds to a row and each parameter (channel) is a column.
These data are transposed before regression</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[xr.Dataset, xr.DataArray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.X">
<span class="sig-name descname"><span class="pre">X</span></span><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.X" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a “pure array” representation of _X used to emulate Gary
Egbert’s matlab codes. It may or may not be deprecated.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array (normally 2-dimensional)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator._Y">
<span class="sig-name descname"><span class="pre">_Y</span></span><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator._Y" title="Permalink to this definition">¶</a></dt>
<dd><p>These are the output variables, arranged same as X above.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.Y">
<span class="sig-name descname"><span class="pre">Y</span></span><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.Y" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a “pure array” representation of _Y used to emulate Gary
Egbert’s matlab codes. It may or may not be deprecated.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array (normally 2-dimensional)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.b">
<span class="sig-name descname"><span class="pre">b</span></span><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.b" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix of regression coefficients, i.e. the solution to the regression
problem.  In our context they are the “Transfer Function”
The dimension of b, to match X and Y is [n_input_ch, n_output_ch]
When we are solving “channel-by-channel”, b is usually [2,1].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array (normally 2-dimensional)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.inverse_signal_covariance">
<span class="sig-name descname"><span class="pre">inverse_signal_covariance</span></span><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.inverse_signal_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>This was Cov_SS in Gary’s matlab codes.  It is basically inv(X.H &#64; X)
Reference needed</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array (n_input_ch, n_input_ch)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.noise_covariance">
<span class="sig-name descname"><span class="pre">noise_covariance</span></span><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.noise_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>This was Cov_NN in Gary’s matlab codes
Reference needed</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array (n_output_ch, n_output_ch)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.squared_coherence">
<span class="sig-name descname"><span class="pre">squared_coherence</span></span><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.squared_coherence" title="Permalink to this definition">¶</a></dt>
<dd><p>This was R2 in Gary’s matlab codes
Formula?  Reference?
Squared coherence (top row is using raw data, bottom cleaned, with crude
correction for amount of downweighted data)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array (n_output_ch)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.Yc">
<span class="sig-name descname"><span class="pre">Yc</span></span><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.Yc" title="Permalink to this definition">¶</a></dt>
<dd><p>A “cleaned” version of Y the output variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array (normally 2-dimensional)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.iter_control">
<span class="sig-name descname"><span class="pre">iter_control</span></span><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.iter_control" title="Permalink to this definition">¶</a></dt>
<dd><p>is a structure which controls the robust scheme iteration.
On return also contains number of iterations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>transfer_function.iter_control.IterControl()</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.Kwargs">
<span class="sig-name descname"><span class="pre">Kwargs</span></span><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.Kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.input_channel_names">
<span class="sig-name descname"><span class="pre">input_channel_names</span></span><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.input_channel_names" title="Permalink to this definition">¶</a></dt>
<dd><p>List of strings for channel names.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.Q" title="aurora.transfer_function.regression.base.RegressionEstimator.Q"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Q</span></code></a></dt><dd><p>Returns the Q matrix from the QR decomposition</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.QH" title="aurora.transfer_function.regression.base.RegressionEstimator.QH"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QH</span></code></a></dt><dd><p>Returns the conjugate transpose of the Q matrix from the QR decomposition</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.QHY" title="aurora.transfer_function.regression.base.RegressionEstimator.QHY"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QHY</span></code></a></dt><dd><p>Returns the QH &#64; Y</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.R" title="aurora.transfer_function.regression.base.RegressionEstimator.R"><code class="xref py py-obj docutils literal notranslate"><span class="pre">R</span></code></a></dt><dd><p>Returns the R matrix from the QR decomposition</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.degrees_of_freedom" title="aurora.transfer_function.regression.base.RegressionEstimator.degrees_of_freedom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">degrees_of_freedom</span></code></a></dt><dd><p>gets the number of degress of freedom in the dataset.</p>
</dd>
<dt><a class="reference internal" href="#id0" title="aurora.transfer_function.regression.base.RegressionEstimator.input_channel_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_channel_names</span></code></a></dt><dd><p>returns the list of channel names associated with X</p>
</dd>
<dt><a class="reference internal" href="#id1" title="aurora.transfer_function.regression.base.RegressionEstimator.inverse_signal_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inverse_signal_covariance</span></code></a></dt><dd><p>Returns the inverse signal covariance matrix of the input channels as xarray</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.is_underdetermined" title="aurora.transfer_function.regression.base.RegressionEstimator.is_underdetermined"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_underdetermined</span></code></a></dt><dd><p>Check if the regression problem is under-determined</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.n_channels_in" title="aurora.transfer_function.regression.base.RegressionEstimator.n_channels_in"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_channels_in</span></code></a></dt><dd><p>Returns the number of input channels.</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.n_channels_out" title="aurora.transfer_function.regression.base.RegressionEstimator.n_channels_out"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_channels_out</span></code></a></dt><dd><p>number of output variables</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.n_data" title="aurora.transfer_function.regression.base.RegressionEstimator.n_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_data</span></code></a></dt><dd><p>Return the number of multivariate observations in the regression dataset.</p>
</dd>
<dt><a class="reference internal" href="#id2" title="aurora.transfer_function.regression.base.RegressionEstimator.noise_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">noise_covariance</span></code></a></dt><dd><p>Returns the noise covariance matrix of the output channels  as xarray</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.output_channel_names" title="aurora.transfer_function.regression.base.RegressionEstimator.output_channel_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_channel_names</span></code></a></dt><dd><p>returns the list of channel names associated with Y</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.b_to_xarray" title="aurora.transfer_function.regression.base.RegressionEstimator.b_to_xarray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">b_to_xarray</span></code></a>()</p></td>
<td><p>Wraps the TF results as an xarray</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.estimate" title="aurora.transfer_function.regression.base.RegressionEstimator.estimate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate</span></code></a>()</p></td>
<td><p>Executes the regression</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.estimate_ols" title="aurora.transfer_function.regression.base.RegressionEstimator.estimate_ols"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_ols</span></code></a>([mode])</p></td>
<td><p>Solve Y = Xb with ordinary least squares, not robust regression.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.qr_decomposition" title="aurora.transfer_function.regression.base.RegressionEstimator.qr_decomposition"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qr_decomposition</span></code></a>([X, sanity_check])</p></td>
<td><p>performs QR decomposition on input matrix X.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator.solve_underdetermined" title="aurora.transfer_function.regression.base.RegressionEstimator.solve_underdetermined"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_underdetermined</span></code></a>()</p></td>
<td><p>Solves the regression problem if it is under-determined -- Not Stable</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.Q">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Q</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.Q" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Q matrix from the QR decomposition</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.QH">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QH</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.QH" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the conjugate transpose of the Q matrix from the QR decomposition</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.QHY">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QHY</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.QHY" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the QH &#64; Y</p>
<p>QHY is a convenience matrix that makes computing the predicted data (QQHY) more efficient.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.R">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">R</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.R" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the R matrix from the QR decomposition</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.b_to_xarray">
<span class="sig-name descname"><span class="pre">b_to_xarray</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/base.html#RegressionEstimator.b_to_xarray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.b_to_xarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps the TF results as an xarray</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.degrees_of_freedom">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degrees_of_freedom</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.degrees_of_freedom" title="Permalink to this definition">¶</a></dt>
<dd><p>gets the number of degress of freedom in the dataset.
Returns
int</p>
<blockquote>
<div><p>The total number of multivariate observations minus the number of input channels.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/base.html#RegressionEstimator.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes the regression</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>b</strong> – The regression solution to Y = Xb</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.estimate_ols">
<span class="sig-name descname"><span class="pre">estimate_ols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'solve'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/base.html#RegressionEstimator.estimate_ols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.estimate_ols" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve Y = Xb with ordinary least squares, not robust regression.</p>
<p>Development Notes:
Brute Force tends to be less stable because we actually compute the
inverse matrix.  It is not recommended, its just here for completeness.
X’Y=X’Xb
(X’X)^-1 X’Y = b</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – must be one of [“qr”, “brute_force”, “solve”]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>b</strong> – Normally the impedance tensor Z</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_channel_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></em><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the list of channel names associated with X</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inverse_signal_covariance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the inverse signal covariance matrix of the input channels as xarray</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.is_underdetermined">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_underdetermined</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.is_underdetermined" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the regression problem is under-determined
:returns: True if regression problem is under-determined, otherwise False
:rtype: bool</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.n_channels_in">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_channels_in</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.n_channels_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of input channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of channels of input data (columns of X)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.n_channels_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_channels_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.n_channels_out" title="Permalink to this definition">¶</a></dt>
<dd><p>number of output variables</p>
<p>Returns
int</p>
<blockquote>
<div><p>number of output variables (Assumed to be num columns of a 2D array)</p>
</div></blockquote>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.n_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.n_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of multivariate observations in the regression dataset.</p>
<dl class="simple">
<dt>Development Notes:</dt><dd><p>This may need to be modified if we use masked arrays</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of rows in the input data vector</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">noise_covariance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataArray</span></em><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the noise covariance matrix of the output channels  as xarray</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.output_channel_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_channel_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.output_channel_names" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the list of channel names associated with Y</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.qr_decomposition">
<span class="sig-name descname"><span class="pre">qr_decomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sanity_check</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/base.html#RegressionEstimator.qr_decomposition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.qr_decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>performs QR decomposition on input matrix X.</p>
<p>If X is not provided as an optional argument then check the value of self.qr_input</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>numpy array</em>) – In RME this is the Input channels X
In RME_RR this is the RR channels Z</p></li>
<li><p><strong>sanity_check</strong> (<em>boolean</em>) – check QR decomposition is working correctly.  Set to True for debugging.
Can probably be deprecated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Q, R</strong> – The matrices Q and R from the QR-decomposition.
X = Q R where Q is unitary/orthogonal and R upper triangular.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.base.RegressionEstimator.solve_underdetermined">
<span class="sig-name descname"><span class="pre">solve_underdetermined</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/base.html#RegressionEstimator.solve_underdetermined"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.base.RegressionEstimator.solve_underdetermined" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves the regression problem if it is under-determined – Not Stable</p>
<p>Development Notes:
20210806
This method was originally in TRME.m, but it does not depend in
general on using RME method so putting it in the base class.</p>
<p>We basically never get here and when we do, we don’t trust the results
<a class="reference external" href="https://docs.scipy.org/doc/numpy-1.9.2/reference/generated/numpy.linalg.svd.html">https://docs.scipy.org/doc/numpy-1.9.2/reference/generated/numpy.linalg.svd.html</a>
<a class="reference external" href="https://www.mathworks.com/help/matlab/ref/double.svd.html">https://www.mathworks.com/help/matlab/ref/double.svd.html</a></p>
<p>Note that the svd outputs are different in matlab and numpy
<a class="reference external" href="https://stackoverflow.com/questions/50930899/svd-command-in-python-v-s-matlab">https://stackoverflow.com/questions/50930899/svd-command-in-python-v-s-matlab</a>
“The SVD of a matrix can be written as</p>
<p>A = U S V^H</p>
<p>Where the ^H signifies the conjugate transpose. Matlab’s svd command returns U, S and V,
while numpy.linalg.svd returns U, the diagonal of S, and V^H.
Thus, to get the same S and V as in Matlab you need to reconstruct the S and also get the V:</p>
<p>ORIGINAL MATLAB</p>
<p>% Overdetermined problem…use svd to invert, return
% NOTE: the solution IS non - unique… and by itself RME is not setup
% to do anything sensible to resolve the non - uniqueness(no prior info
% is passed!).  This is stop-gap, to prevent errors when using RME as
% part of some other estimation scheme!
[u,s,v] = svd(obj.X,’econ’);
sInv = 1./diag(s);
obj.b = v*diag(sInv)*u’<a href="#id3"><span class="problematic" id="id4">*</span></a>obj.Y;
if ITER.returnCovariance</p>
<blockquote>
<div><p>obj.Cov_NN = zeros(K,K);
obj.Cov_SS = zeros(nParam,nParam);</p>
</div></blockquote>
<p>end
result = obj.b</p>
<hr class="docutils" />
</dd></dl>

</dd></dl>

</section>
<section id="module-aurora.transfer_function.regression.helper_functions">
<span id="aurora-transfer-function-regression-helper-functions-module"></span><h2>aurora.transfer_function.regression.helper_functions module<a class="headerlink" href="#module-aurora.transfer_function.regression.helper_functions" title="Permalink to this heading">¶</a></h2>
<p>This module contains methods for performing regression to solve Y = Xb.</p>
<dl class="py function">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.helper_functions.direct_solve_tf">
<span class="sig-prename descclassname"><span class="pre">aurora.transfer_function.regression.helper_functions.</span></span><span class="sig-name descname"><span class="pre">direct_solve_tf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/helper_functions.html#direct_solve_tf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.helper_functions.direct_solve_tf" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve problem Y = Xb for b.</p>
<dl class="simple">
<dt>This function can be used for testing.  It is not as stable as using simple_solve_tf,</dt><dd><p>but it is instructive to have an example of regression using the crudest approach.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – The “output” of regression problem.  For testing this often has shape (N,).
Y is normally a vector of Electric field FCs</p></li>
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – The “input” of regression problem.  For testing this often has shape (N,2).
X is normally an array of Magnetic field FCs (two-component)</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a><em> or </em><em>None</em>) – Remote reference channels (optional)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>z</strong> – The TF estimate – Usually two complex numbers, (Zxx, Zxy), or (Zyx, Zyy)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.helper_functions.rme_beta">
<span class="sig-prename descclassname"><span class="pre">aurora.transfer_function.regression.helper_functions.</span></span><span class="sig-name descname"><span class="pre">rme_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/helper_functions.html#rme_beta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.helper_functions.rme_beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a normalization factor to correct for bias in residual variance.</p>
<p>Details:
- This is an RME specific property.  It represents a bias in the calculation of
residual_variance which we correct for in TRME and TRME_RR. The implemented
formula is an approximation.  This is approximately equal to 1/beta where beta is
defined by Equation A3 in Egbert &amp; Booker 1986.</p>
<p>For r0=1.5 the correction factor is ~1.28 and beta ~0.78</p>
<p>Some notes from a discussion with Gary:
In the regression estimate you down-weight things with large errors, but you need
to define what is large.  You estimate the standard deviation (sigma) of the errors
from the residuals BUT with this cleaned data approach (Yc) sigma is smaller than
it should be.  You need to compensate for this by using a correction_factor. It’s
basically the expectation, if the data really were Gaussian, and you estimated from
the corrected data. This is how much too small the estimate would be.</p>
<p>If you change the penalty functional you may need pencil, paper and some calculus.
The relationship between the corrected-data-residuals and the Gaussian residuals
could change if you change the penalty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – The number of standard errors at which the RME method transitions from
quadratic weighting to linear</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>beta</strong> – correction factor = 1/beta</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.helper_functions.simple_solve_tf">
<span class="sig-prename descclassname"><span class="pre">aurora.transfer_function.regression.helper_functions.</span></span><span class="sig-name descname"><span class="pre">simple_solve_tf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/helper_functions.html#simple_solve_tf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.helper_functions.simple_solve_tf" title="Permalink to this definition">¶</a></dt>
<dd><p>Cast problem Y = Xb into scipy.linalg.solve form which solves: a &#64; x = b</p>
<ul class="simple">
<li><p>Note that the “b” in the two equations is different.
- The EMTF regression problem (and many regression problems in general) use Y=Xb
- Y, X are known and b is the solution
- scipy.linalg.solve form which solves: a &#64; x = b
- Here a, b are known and x is the solution.</p></li>
<li><p>This function is used for testing vectorized, direct solver.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – The “output” of regression problem.  For testing this often has shape (N,).
Y is normally a vector of Electric field FCs</p></li>
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – The “input” of regression problem.  For testing this often has shape (N,2).
X is normally an array of Magnetic field FCs (two-component)</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a><em> or </em><em>None</em>) – Remote reference channels (optional)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>z</strong> – The TF estimate – Usually two complex numbers, (Zxx, Zxy), or (Zyx, Zyy)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-aurora.transfer_function.regression.iter_control">
<span id="aurora-transfer-function-regression-iter-control-module"></span><h2>aurora.transfer_function.regression.iter_control module<a class="headerlink" href="#module-aurora.transfer_function.regression.iter_control" title="Permalink to this heading">¶</a></h2>
<p>This module contains a class that holds parameters to control the iterations of
robust regression including convergence criteria and thresholds.</p>
<p>Based on Gary’s IterControl.m in
iris_mt_scratch/egbert_codes-20210121T193218Z-001/egbert_codes/matlabPrototype_10-13-20/TF/classes</p>
<dl class="py class">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.iter_control.IterControl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aurora.transfer_function.regression.iter_control.</span></span><span class="sig-name descname"><span class="pre">IterControl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_number_of_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_number_of_redescending_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/iter_control.html#IterControl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.iter_control.IterControl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p class="rubric">Notes</p>
<p>Here is a class to hold variables that are used to control the regression
- currently this is used for variations on RME (Robust M-Estimator)
- TODO: in the original matlab code there was a class property called <cite>epsilon</cite>, but
it was unused; There was no documentation about it’s purpose, except possibly that
the abstract base class solved Y = X*b + epsilon for b, complex-valued.
Perhaps this was intended as an intrinsic tolerated noise level.  The value of
epsilon was set to 1000.
- TODO The return covariance boolean just initializes arrays of zeros.  Needs to be</p>
<blockquote>
<div><p>made functional or removed</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#aurora.transfer_function.regression.iter_control.IterControl.continue_redescending" title="aurora.transfer_function.regression.iter_control.IterControl.continue_redescending"><code class="xref py py-obj docutils literal notranslate"><span class="pre">continue_redescending</span></code></a></dt><dd><p>Checks if the max_number_of_redescending_iterations has been reached</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.iter_control.IterControl.correction_factor" title="aurora.transfer_function.regression.iter_control.IterControl.correction_factor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">correction_factor</span></code></a></dt><dd><p>Returns correction factor for residual variances.</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.iter_control.IterControl.max_iterations_reached" title="aurora.transfer_function.regression.iter_control.IterControl.max_iterations_reached"><code class="xref py py-obj docutils literal notranslate"><span class="pre">max_iterations_reached</span></code></a></dt><dd><p>Return True of the number of iterations carried out is greater or equal the</p>
</dd>
<dt><strong>number_of_iterations</strong></dt><dd></dd>
<dt><strong>number_of_redescending_iterations</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.iter_control.IterControl.converged" title="aurora.transfer_function.regression.iter_control.IterControl.converged"><code class="xref py py-obj docutils literal notranslate"><span class="pre">converged</span></code></a>(b, b0)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">param b<span class="colon">:</span></dt>
<dd class="field-odd"><p>the most recent regression estimate</p>
</dd>
</dl>
</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>increment_iteration_number</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>increment_redescending_iteration_number</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>reset_number_of_iterations</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>reset_number_of_redescending_iterations</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.iter_control.IterControl.continue_redescending">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">continue_redescending</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.iter_control.IterControl.continue_redescending" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the max_number_of_redescending_iterations has been reached</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>maxxed_out</strong> – True if max_number_of_redescending_iterations has been reached, otherwise False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.iter_control.IterControl.converged">
<span class="sig-name descname"><span class="pre">converged</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/iter_control.html#IterControl.converged"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.iter_control.IterControl.converged" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<em>complex-valued numpy array</em>) – the most recent regression estimate</p></li>
<li><p><strong>b0</strong> (<em>complex-valued numpy array</em>) – The previous regression estimate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>converged</strong> (<em>bool</em>) – True of the regression has terminated, False otherwise</p></li>
<li><p><em>Developement Notes</em></p></li>
<li><p><em>The variable maximum_change finds the maximum amplitude component of the vector</em></p></li>
<li><p><em>1 - b/b0.  Looking at the formula, one might want to cast this instead as</em></p></li>
<li><p><em>1 - abs(b/b0), however, that will be insensitive to phase changes in b,</em></p></li>
<li><p><em>which is complex valued.  The way it is coded np.max(np.abs(1 - b / b0)) is</em></p></li>
<li><p><em>correct as it stands.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.iter_control.IterControl.correction_factor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">correction_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.iter_control.IterControl.correction_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns correction factor for residual variances.</p>
<p>Detailed notes on usage in
transfer_function.regression.helper_functions.rme_beta</p>
<dl class="simple">
<dt>TODO: This is an RME specific property.  Suggest move r0, u0 and this method</dt><dd><p>into an RME-config class.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>correction_factor</strong> – correction factor used for scaling the residual error_variance</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.iter_control.IterControl.increment_iteration_number">
<span class="sig-name descname"><span class="pre">increment_iteration_number</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/iter_control.html#IterControl.increment_iteration_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.iter_control.IterControl.increment_iteration_number" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.iter_control.IterControl.increment_redescending_iteration_number">
<span class="sig-name descname"><span class="pre">increment_redescending_iteration_number</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/iter_control.html#IterControl.increment_redescending_iteration_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.iter_control.IterControl.increment_redescending_iteration_number" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.iter_control.IterControl.max_iterations_reached">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_iterations_reached</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.iter_control.IterControl.max_iterations_reached" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True of the number of iterations carried out is greater or equal the
maximum number of iterations set in the processing config</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.iter_control.IterControl.number_of_iterations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">number_of_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.iter_control.IterControl.number_of_iterations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.iter_control.IterControl.number_of_redescending_iterations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">number_of_redescending_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.iter_control.IterControl.number_of_redescending_iterations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.iter_control.IterControl.reset_number_of_iterations">
<span class="sig-name descname"><span class="pre">reset_number_of_iterations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/iter_control.html#IterControl.reset_number_of_iterations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.iter_control.IterControl.reset_number_of_iterations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.iter_control.IterControl.reset_number_of_redescending_iterations">
<span class="sig-name descname"><span class="pre">reset_number_of_redescending_iterations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/iter_control.html#IterControl.reset_number_of_redescending_iterations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.iter_control.IterControl.reset_number_of_redescending_iterations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-aurora.transfer_function.regression.m_estimator">
<span id="aurora-transfer-function-regression-m-estimator-module"></span><h2>aurora.transfer_function.regression.m_estimator module<a class="headerlink" href="#module-aurora.transfer_function.regression.m_estimator" title="Permalink to this heading">¶</a></h2>
<p>This module contains the MEstimator class - an extension of RegressionEstimator.</p>
<blockquote>
<div><p>MEstimator has the class methods that are common to both RME and RME_RR.
See Notes in RME, RME_RR for more details.</p>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aurora.transfer_function.regression.m_estimator.</span></span><span class="sig-name descname"><span class="pre">MEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aurora.transfer_function.regression.base.RegressionEstimator" title="aurora.transfer_function.regression.base.RegressionEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegressionEstimator</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Q</span></code></dt><dd><p>Returns the Q matrix from the QR decomposition</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QH</span></code></dt><dd><p>Returns the conjugate transpose of the Q matrix from the QR decomposition</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QHY</span></code></dt><dd><p>Returns the QH &#64; Y</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.QHYc" title="aurora.transfer_function.regression.m_estimator.MEstimator.QHYc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QHYc</span></code></a></dt><dd><p>Returns the matrix QH &#64; Yc This is Q.conj().T from the QR decomposition multiplied with the cleaned data.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">R</span></code></dt><dd><p>Returns the R matrix from the QR decomposition</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.Y_hat" title="aurora.transfer_function.regression.m_estimator.MEstimator.Y_hat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Y_hat</span></code></a></dt><dd><p>returns the most recent predicted data</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.correction_factor" title="aurora.transfer_function.regression.m_estimator.MEstimator.correction_factor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">correction_factor</span></code></a></dt><dd><p>Return teh correction factor for the residual variance.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">degrees_of_freedom</span></code></dt><dd><p>gets the number of degress of freedom in the dataset.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_channel_names</span></code></dt><dd><p>returns the list of channel names associated with X</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">inverse_signal_covariance</span></code></dt><dd><p>Returns the inverse signal covariance matrix of the input channels as xarray</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_underdetermined</span></code></dt><dd><p>Check if the regression problem is under-determined</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_channels_in</span></code></dt><dd><p>Returns the number of input channels.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_channels_out</span></code></dt><dd><p>number of output variables</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_data</span></code></dt><dd><p>Return the number of multivariate observations in the regression dataset.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">noise_covariance</span></code></dt><dd><p>Returns the noise covariance matrix of the output channels  as xarray</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_channel_names</span></code></dt><dd><p>returns the list of channel names associated with Y</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.r0" title="aurora.transfer_function.regression.m_estimator.MEstimator.r0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">r0</span></code></a></dt><dd><p>returns the Huber r0 value</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.residual_variance" title="aurora.transfer_function.regression.m_estimator.MEstimator.residual_variance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">residual_variance</span></code></a></dt><dd><p>returns the residual variance</p>
</dd>
<dt><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.u0" title="aurora.transfer_function.regression.m_estimator.MEstimator.u0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u0</span></code></a></dt><dd><p>returns the u0 threshold for redescending regression step</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.apply_huber_regression" title="aurora.transfer_function.regression.m_estimator.MEstimator.apply_huber_regression"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_huber_regression</span></code></a>()</p></td>
<td><p>This is the 'convergence loop' from RME, RME_RR</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.apply_redecending_influence_function" title="aurora.transfer_function.regression.m_estimator.MEstimator.apply_redecending_influence_function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_redecending_influence_function</span></code></a>()</p></td>
<td><p>Performs one or two iterations with re-descending influence curve cleaned data</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">b_to_xarray</span></code>()</p></td>
<td><p>Wraps the TF results as an xarray</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.compute_noise_covariance" title="aurora.transfer_function.regression.m_estimator.MEstimator.compute_noise_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_noise_covariance</span></code></a>()</p></td>
<td><p>Computes the noise covariance (covariance of the residuals)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.compute_squared_coherence" title="aurora.transfer_function.regression.m_estimator.MEstimator.compute_squared_coherence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_squared_coherence</span></code></a>()</p></td>
<td><p>Updates the array self.R2</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.estimate" title="aurora.transfer_function.regression.m_estimator.MEstimator.estimate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate</span></code></a>()</p></td>
<td><p>Executes the regression</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_ols</span></code>([mode])</p></td>
<td><p>Solve Y = Xb with ordinary least squares, not robust regression.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.initial_estimate" title="aurora.transfer_function.regression.m_estimator.MEstimator.initial_estimate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initial_estimate</span></code></a>()</p></td>
<td><p>Make first estimate of TF (b), Y_hat, and residual_variance</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">qr_decomposition</span></code>([X, sanity_check])</p></td>
<td><p>performs QR decomposition on input matrix X.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.residual_variance_method1" title="aurora.transfer_function.regression.m_estimator.MEstimator.residual_variance_method1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">residual_variance_method1</span></code></a>()</p></td>
<td><p>returns the residual variance of the output channels.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.residual_variance_method2" title="aurora.transfer_function.regression.m_estimator.MEstimator.residual_variance_method2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">residual_variance_method2</span></code></a>()</p></td>
<td><p>Returns the residual variance of the output channels (error variances).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_underdetermined</span></code>()</p></td>
<td><p>Solves the regression problem if it is under-determined -- Not Stable</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.update_QHYc" title="aurora.transfer_function.regression.m_estimator.MEstimator.update_QHYc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_QHYc</span></code></a>()</p></td>
<td><p>Updates the QHYc matrix with the most recent cleaned data</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.update_residual_variance" title="aurora.transfer_function.regression.m_estimator.MEstimator.update_residual_variance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_residual_variance</span></code></a>([correction_factor])</p></td>
<td><p>updates residual variance from most recent cleaned and predicted data</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.update_y_cleaned_via_huber_weights" title="aurora.transfer_function.regression.m_estimator.MEstimator.update_y_cleaned_via_huber_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_y_cleaned_via_huber_weights</span></code></a>()</p></td>
<td><p>Updates the values of self.Yc and self.expectation_psi_prime</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.update_y_cleaned_via_redescend_weights" title="aurora.transfer_function.regression.m_estimator.MEstimator.update_y_cleaned_via_redescend_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_y_cleaned_via_redescend_weights</span></code></a>()</p></td>
<td><p>Updates estimate for self.Yc as a match-filtered sum of Y and Y_hat.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#aurora.transfer_function.regression.m_estimator.MEstimator.update_y_hat" title="aurora.transfer_function.regression.m_estimator.MEstimator.update_y_hat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_y_hat</span></code></a>()</p></td>
<td><p>updates the predicted data from the most recent cleaned data</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.QHYc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QHYc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.QHYc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the matrix QH &#64; Yc
This is Q.conj().T from the QR decomposition multiplied with the cleaned data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>QHYc</strong> – A convenience matrix that makes computing the predicted data (QQHYc) more efficient.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.Y_hat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Y_hat</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.Y_hat" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the most recent predicted data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.apply_huber_regression">
<span class="sig-name descname"><span class="pre">apply_huber_regression</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.apply_huber_regression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.apply_huber_regression" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This is the ‘convergence loop’ from RME, RME_RR</p>
</div></blockquote>
<dl class="simple">
<dt>TODO: Consider not setting iter_control.number_of_iterations</dt><dd><ul class="simple">
<li><p>Instead, Initialize a new iter_control object</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.apply_redecending_influence_function">
<span class="sig-name descname"><span class="pre">apply_redecending_influence_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.apply_redecending_influence_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.apply_redecending_influence_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs one or two iterations with re-descending influence curve cleaned data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.compute_noise_covariance">
<span class="sig-name descname"><span class="pre">compute_noise_covariance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.compute_noise_covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.compute_noise_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the noise covariance (covariance of the residuals)</p>
<p>res_clean: The cleaned data minus the predicted data. The residuals
SSR_clean: Sum of squares of the residuals.  Diagonal is real
:param Y_hat:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.compute_squared_coherence">
<span class="sig-name descname"><span class="pre">compute_squared_coherence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.compute_squared_coherence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.compute_squared_coherence" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the array self.R2</p>
<p>Here is taken the ratio of the energy in the residuals with the energy in the cleaned data.
This metric can be interpreted as how much of the signal (Y) is “explained” by the regression.</p>
<p>Development Notes:
The matlab code (TRME_RR) claimed:</p>
<blockquote>
<div><p>%  R2 is squared coherence (top row is using raw data, bottom
%    cleaned, with crude correction for amount of down-weighted data)</p>
</div></blockquote>
<dl class="simple">
<dt>TODO: There seem to be other valid metrics for this sort of quantity.  In particular, we may want to</dt><dd><p>consider SSY (the sum of squares of the observed data) over SSR.</p>
</dd>
<dt>TODO: consider renaming self.R2.  That name invokes the idea of the squared residuals.  That is not what</dt><dd><p>is being stored in self.R2.  This is more like a CMRR.</p>
</dd>
</dl>
<p>res: Residuals, the original data minus the predicted data.
SSR : Sum of squares of the residuals, per channel</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.correction_factor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">correction_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.correction_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return teh correction factor for the residual variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>correction_factor</strong> – See doc in iter_control.IterControl.correction_factor()</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes the regression</p>
<p>Development Notes:
Here is a comment from the matlab codes:
“need to look at how we should compute adjusted residual cov to make</p>
<blockquote>
<div><p>consistent with tranmt”</p>
</div></blockquote>
<p>See issue#69 aurora github repo addresses this</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.initial_estimate">
<span class="sig-name descname"><span class="pre">initial_estimate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.initial_estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.initial_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Make first estimate of TF (b), Y_hat, and residual_variance</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.r0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.r0" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the Huber r0 value</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.residual_variance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">residual_variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.residual_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the residual variance</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.residual_variance_method1">
<span class="sig-name descname"><span class="pre">residual_variance_method1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.residual_variance_method1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.residual_variance_method1" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the residual variance of the output channels.</p>
<p>This is the method that was originally in RME_RR.m.  It seems more correct
than the one in RME, but also has more computational overhead.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.residual_variance_method2">
<span class="sig-name descname"><span class="pre">residual_variance_method2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.residual_variance_method2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.residual_variance_method2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the residual variance of the output channels (error variances).</p>
<p>Computes the squared norms difference of the output channels from the
“output channels inner-product with QQH”</p>
<p>This method used to take either QHY, Y as arguments or QHYc, Yc
But now that Yc initializes to Y, we can just use with QHYc, Yc always
(Note QHYc is updated everytime Yc is updated)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>QHY</strong> (<em>numpy array</em>) – QHY[i,j] = Q.H * Y[i,j] = &lt;Q[:,i], Y[:,j]&gt;
So when we sum columns of norm(QHY) we are get in the zeroth position
&lt;Q[:,0], Y[:,0]&gt; +  &lt;Q[:,1], Y[:,0]&gt;, that is the 0th channel of Y
projected onto each of the Q-basis vectors</p></li>
<li><p><strong>Y_or_Yc</strong> (<em>numpy array</em>) – The output channels (self.Y) or the cleaned output channels self.Yc</p></li>
<li><p><strong>correction_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – See doc in IterControl.correction_factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>residual_variance</strong> – One entry per output channel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.u0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">u0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.u0" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the u0 threshold for redescending regression step</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.update_QHYc">
<span class="sig-name descname"><span class="pre">update_QHYc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.update_QHYc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.update_QHYc" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the QHYc matrix with the most recent cleaned data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.update_residual_variance">
<span class="sig-name descname"><span class="pre">update_residual_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">correction_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.update_residual_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.update_residual_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>updates residual variance from most recent cleaned and predicted data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.update_y_cleaned_via_huber_weights">
<span class="sig-name descname"><span class="pre">update_y_cleaned_via_huber_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.update_y_cleaned_via_huber_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.update_y_cleaned_via_huber_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the values of self.Yc and self.expectation_psi_prime</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>residual_variance</strong> (<em>numpy array</em>) – 1D array, the same length as the number of output channels
see self.residual_variance() method for its calculation</p></li>
<li><p><strong>Y_hat</strong> (<em>numpy array</em>) – The predicted data, usually from QQHY</p></li>
</ul>
</dd>
</dl>
<p>Original matlab documenation:
function [YC,E_psiPrime] = HuberWt(Y,YP,sig,r0)
inputs are data (Y) and predicted (YP), estiamted
error variances (for each column) and Huber parameter r0
allows for multiple columns of data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.update_y_cleaned_via_redescend_weights">
<span class="sig-name descname"><span class="pre">update_y_cleaned_via_redescend_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.update_y_cleaned_via_redescend_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.update_y_cleaned_via_redescend_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates estimate for self.Yc as a match-filtered sum of Y and Y_hat.</p>
<p>Note: It is not unheard of to observe RuntimeWarning: overflow encountered in exp in the calculation of t.
This can happen when large residuals are present.  In that case, t goes to -inf, and w goes to zero,
– the desired behaviour.  When this happens an “invalid value” will also occur  in the calculation
of t, but this does not propagate into self.expectation_psi_prime.</p>
<p>Matlab documentation:
function[YC, E_psiPrime] = RedescendWt(Y, YP, sig, u0):
inputs are data(Y) and predicted(YP), estimated error variances (for each
column) and Huber parameter u0.  Allows for multiple columns of data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Y_hat</strong> (<em>numpy array</em>) – An estimate of the output data Y obtained by
self.Q &#64; self.QHY
or
self.Q &#64; self.QHYc</p></li>
<li><p><strong>residual_variance</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aurora.transfer_function.regression.m_estimator.MEstimator.update_y_hat">
<span class="sig-name descname"><span class="pre">update_y_hat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/aurora/transfer_function/regression/m_estimator.html#MEstimator.update_y_hat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aurora.transfer_function.regression.m_estimator.MEstimator.update_y_hat" title="Permalink to this definition">¶</a></dt>
<dd><p>updates the predicted data from the most recent cleaned data</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-aurora.transfer_function.regression">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-aurora.transfer_function.regression" title="Permalink to this heading">¶</a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="aurora.transfer_function.plot.html" class="btn btn-neutral float-left" title="aurora.transfer_function.plot package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="aurora.transfer_function.weights.html" class="btn btn-neutral float-right" title="aurora.transfer_function.weights package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Karl Kappler, Jared Peacock, Andy Frassetto, Tim Ronan, Lindsey Heagy, Douglas Oldenburg.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>